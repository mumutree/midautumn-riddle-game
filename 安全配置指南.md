# 🔒 安全配置指南

## 概述
本项目采用多层安全策略，确保数据库密钥和敏感信息不会暴露在前端代码中。

## 🚨 安全原则

### 1. 零信任原则
- **永远不要**在前端代码中硬编码任何密钥
- **永远不要**将包含真实密钥的文件提交到Git仓库
- **永远不要**在客户端可访问的地方存储敏感信息

### 2. 分层防护
- 开发环境：本地配置文件（不上传）
- 生产环境：服务端API + 环境变量
- 版本控制：只包含模板和示例文件

## 📁 配置文件说明

### 开发环境文件（不上传）
```
config.js                 # 本地开发配置（包含真实密钥）
config-production.js       # 生产环境配置（包含真实密钥）
```
这些文件已在 `.gitignore` 中排除，**绝对不会**上传到GitHub。

### 生产环境文件（可上传）
```
api/config.js             # 服务端API端点
vercel.json               # Vercel部署配置
config.example.js         # 配置模板（仅示例，无真实密钥）
```

## 🔧 配置流程

### 开发环境设置
1. 复制 `config.example.js` 为 `config.js`
2. 在 `config.js` 中填入真实的Supabase配置
3. 本地开发时，应用会自动使用 `config.js`

### 生产环境部署
1. 在Vercel中设置环境变量：
   - `SUPABASE_URL`
   - `SUPABASE_ANON_KEY`
2. 应用通过 `/api/config` 端点安全获取配置
3. 前端代码不包含任何真实密钥

## 🛡️ 安全检查清单

### 提交前检查
- [ ] 确认没有硬编码任何密钥
- [ ] 确认 `config.js` 和 `config-production.js` 不在提交列表中
- [ ] 确认所有敏感信息都通过环境变量处理
- [ ] 确认 `.gitignore` 正确配置

### 部署前检查
- [ ] Vercel环境变量已正确设置
- [ ] API端点正常工作
- [ ] 前端能正确获取配置
- [ ] 生产环境不依赖本地配置文件

## 🚫 常见安全错误

### ❌ 错误做法
```javascript
// 直接在前端硬编码密钥
const SUPABASE_CONFIG = {
    URL: 'https://real-project-url.supabase.co',
    ANON_KEY: 'real-anon-key-here'
};
```

### ✅ 正确做法
```javascript
// 通过API安全获取配置
async function initializeSupabase() {
    const response = await fetch('/api/config');
    const config = await response.json();
    // 使用获取到的配置...
}
```

## 🔄 应急处理

### 如果密钥意外泄露
1. 立即在Supabase控制台重置密钥
2. 更新Vercel环境变量
3. 重新部署应用
4. 检查Git历史，如有必要清理敏感信息

### 如果配置文件意外提交
1. 立即从仓库中删除敏感文件
2. 重置相关密钥
3. 更新 `.gitignore` 规则
4. 强制推送清理后的历史记录

## 📞 联系方式
如发现任何安全问题，请立即联系项目维护者。

---
**记住：安全是第一位的，永远不要为了便利而妥协安全性！**